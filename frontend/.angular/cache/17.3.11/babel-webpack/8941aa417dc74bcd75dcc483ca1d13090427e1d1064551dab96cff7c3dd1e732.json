{"ast":null,"code":"import { EventEmitter, inject } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ApiService } from '../../services/api.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nconst _c0 = (a0, a1, a2) => ({\n  \"badge-info\": a0,\n  \"badge-success\": a1,\n  \"badge-warning\": a2\n});\nfunction PreviewComponent_div_13_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 12)(1, \"span\", 4);\n    i0.ɵɵtext(2, \"\\u2717\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\")(4, \"p\", 5);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\", 6);\n    i0.ɵɵtext(7, \"Hojas con Errores\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(5);\n    i0.ɵɵtextInterpolate(ctx_r0.invalidSheets.length);\n  }\n}\nfunction PreviewComponent_div_22_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 16);\n    i0.ɵɵlistener(\"click\", function PreviewComponent_div_22_div_4_Template_div_click_0_listener() {\n      const sheet_r3 = i0.ɵɵrestoreView(_r2).$implicit;\n      const ctx_r0 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r0.toggleSheet(sheet_r3.name));\n    });\n    i0.ɵɵelementStart(1, \"div\", 17)(2, \"input\", 18);\n    i0.ɵɵlistener(\"click\", function PreviewComponent_div_22_div_4_Template_input_click_2_listener($event) {\n      i0.ɵɵrestoreView(_r2);\n      return i0.ɵɵresetView($event.stopPropagation());\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(3, \"div\", 19)(4, \"p\", 20);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(6, \"p\", 21);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"span\", 22);\n    i0.ɵɵtext(9, \"\\u2713\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const sheet_r3 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"selected\", ctx_r0.isSheetSelected(sheet_r3.name));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"checked\", ctx_r0.isSheetSelected(sheet_r3.name));\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(sheet_r3.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", sheet_r3.rows || 0, \" registros\");\n  }\n}\nfunction PreviewComponent_div_22_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 13)(1, \"h3\");\n    i0.ɵɵtext(2, \"\\u2705 Hojas V\\u00E1lidas\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 14);\n    i0.ɵɵtemplate(4, PreviewComponent_div_22_div_4_Template, 10, 5, \"div\", 15);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.validSheets);\n  }\n}\nfunction PreviewComponent_div_23_div_4_li_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"li\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const error_r4 = ctx.$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(error_r4);\n  }\n}\nfunction PreviewComponent_div_23_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 24)(1, \"div\", 19)(2, \"p\", 20);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"p\", 21);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(6, \"div\", 25)(7, \"details\")(8, \"summary\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"ul\");\n    i0.ɵɵtemplate(11, PreviewComponent_div_23_div_4_li_11_Template, 2, 1, \"li\", 26);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const sheet_r5 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(sheet_r5.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"\", sheet_r5.rows || 0, \" registros\");\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\"Ver errores (\", sheet_r5.errors.length || 0, \")\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", sheet_r5.errors);\n  }\n}\nfunction PreviewComponent_div_23_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 13)(1, \"h3\");\n    i0.ɵɵtext(2, \"\\u26A0\\uFE0F Hojas con Errores\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 14);\n    i0.ɵɵtemplate(4, PreviewComponent_div_23_div_4_Template, 12, 4, \"div\", 23);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.invalidSheets);\n  }\n}\nfunction PreviewComponent_div_24_span_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"\\uD83D\\uDC41\\uFE0F Previsualizar Datos\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction PreviewComponent_div_24_span_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \"Cargando...\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction PreviewComponent_div_24_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r6 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 27)(1, \"button\", 28);\n    i0.ɵɵlistener(\"click\", function PreviewComponent_div_24_Template_button_click_1_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r0 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r0.loadPreview());\n    });\n    i0.ɵɵtemplate(2, PreviewComponent_div_24_span_2_Template, 2, 0, \"span\", 29)(3, PreviewComponent_div_24_span_3_Template, 2, 0, \"span\", 29);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"button\", 30);\n    i0.ɵɵlistener(\"click\", function PreviewComponent_div_24_Template_button_click_4_listener() {\n      i0.ɵɵrestoreView(_r6);\n      const ctx_r0 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r0.goBack());\n    });\n    i0.ɵɵtext(5, \" \\u2190 Volver \");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"disabled\", ctx_r0.selectedSheets.size === 0 || ctx_r0.isLoadingPreview);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", !ctx_r0.isLoadingPreview);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.isLoadingPreview);\n  }\n}\nfunction PreviewComponent_div_25_button_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 35);\n    i0.ɵɵlistener(\"click\", function PreviewComponent_div_25_button_4_Template_button_click_0_listener() {\n      const preview_r8 = i0.ɵɵrestoreView(_r7).$implicit;\n      const ctx_r0 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r0.setActiveTab(preview_r8.sheet_name));\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const preview_r8 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext(2);\n    i0.ɵɵclassProp(\"active\", ctx_r0.activeTab === preview_r8.sheet_name);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate2(\" \", preview_r8.sheet_name, \" (\", preview_r8.total_rows, \") \");\n  }\n}\nfunction PreviewComponent_div_25_div_5_tr_19_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\")(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\")(6, \"span\", 39);\n    i0.ɵɵtext(7);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"td\");\n    i0.ɵɵtext(9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"td\", 40);\n    i0.ɵɵtext(11);\n    i0.ɵɵpipe(12, \"number\");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const row_r9 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r9.nombre);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r9.edad);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngClass\", i0.ɵɵpureFunction3(9, _c0, row_r9.sexo === \"Masculino\", row_r9.sexo === \"Femenino\", row_r9.sexo === \"Otro\"));\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", row_r9.sexo, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(row_r9.cargo);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"$\", i0.ɵɵpipeBind2(12, 6, row_r9.sueldo, \"1.2-2\"), \"\");\n  }\n}\nfunction PreviewComponent_div_25_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 36)(1, \"div\", 37)(2, \"p\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(4, \"div\", 38)(5, \"table\")(6, \"thead\")(7, \"tr\")(8, \"th\");\n    i0.ɵɵtext(9, \"Nombre\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(10, \"th\");\n    i0.ɵɵtext(11, \"Edad\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"th\");\n    i0.ɵɵtext(13, \"Sexo\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(14, \"th\");\n    i0.ɵɵtext(15, \"Cargo\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"th\");\n    i0.ɵɵtext(17, \"Sueldo\");\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(18, \"tbody\");\n    i0.ɵɵtemplate(19, PreviewComponent_div_25_div_5_tr_19_Template, 13, 13, \"tr\", 26);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const preview_r10 = ctx.$implicit;\n    const ctx_r0 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"hidden\", ctx_r0.activeTab !== preview_r10.sheet_name);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate2(\"Mostrando primeros \", preview_r10.data.length || 0, \" de \", preview_r10.total_rows, \" registros\");\n    i0.ɵɵadvance(16);\n    i0.ɵɵproperty(\"ngForOf\", preview_r10.data);\n  }\n}\nfunction PreviewComponent_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 31)(1, \"h2\");\n    i0.ɵɵtext(2, \"\\uD83D\\uDD0D Previsualizaci\\u00F3n de Datos\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 32);\n    i0.ɵɵtemplate(4, PreviewComponent_div_25_button_4_Template, 2, 4, \"button\", 33);\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(5, PreviewComponent_div_25_div_5_Template, 20, 4, \"div\", 34);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.previewData);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.previewData);\n  }\n}\nexport let PreviewComponent = /*#__PURE__*/(() => {\n  class PreviewComponent {\n    constructor() {\n      this.file = null;\n      this.sheetsSelected = new EventEmitter();\n      this.importComplete = new EventEmitter();\n      this.backToUpload = new EventEmitter();\n      this.apiService = inject(ApiService);\n      this.selectedSheets = new Set();\n      this.previewData = [];\n      this.isLoadingPreview = false;\n      this.isImporting = false;\n      this.showPreview = false;\n      this.activeTab = '';\n      this.importMessage = '';\n      this.importError = '';\n      this.errorMessage = '';\n      this.successMessage = '';\n    }\n    ngOnChanges(changes) {\n      if (changes['validationResult'] && this.validationResult) {\n        this.initializeValidation();\n      }\n    }\n    initializeValidation() {\n      if (this.validationResult && this.validationResult.valid_sheets && this.validationResult.valid_sheets.length > 0) {\n        this.selectedSheets.clear();\n        this.validationResult.valid_sheets.forEach(sheet => {\n          this.selectedSheets.add(sheet.name);\n        });\n        this.activeTab = this.validationResult.valid_sheets[0].name;\n        this.sheetsSelected.emit(Array.from(this.selectedSheets));\n      }\n    }\n    toggleSheet(sheetName) {\n      if (this.selectedSheets.has(sheetName)) {\n        this.selectedSheets.delete(sheetName);\n      } else {\n        this.selectedSheets.add(sheetName);\n      }\n      this.sheetsSelected.emit(Array.from(this.selectedSheets));\n    }\n    isSheetSelected(sheetName) {\n      return this.selectedSheets.has(sheetName);\n    }\n    get hasSelectedSheets() {\n      return this.selectedSheets.size > 0;\n    }\n    get selectedSheetsCount() {\n      return this.selectedSheets.size;\n    }\n    loadPreview() {\n      if (!this.file || this.selectedSheets.size === 0) {\n        this.importError = 'Debe seleccionar al menos una hoja para previsualizar';\n        return;\n      }\n      this.isLoadingPreview = true;\n      this.importError = '';\n      this.errorMessage = '';\n      this.apiService.previewExcel(this.file, Array.from(this.selectedSheets)).subscribe({\n        next: response => {\n          this.isLoadingPreview = false;\n          if (response.status === 200 && response.data) {\n            // Mapear los datos al formato esperado\n            this.previewData = response.data.map(sheet => ({\n              sheet_name: sheet.sheet_name,\n              headers: sheet.headers,\n              rows: sheet.rows || [],\n              data: sheet.rows || [],\n              total_rows: sheet.total_rows\n            }));\n            this.showPreview = true;\n            if (this.previewData.length > 0) {\n              this.activeTab = this.previewData[0].sheet_name;\n            }\n          } else {\n            this.importError = response.message || 'Error al cargar preview';\n          }\n        },\n        error: error => {\n          this.isLoadingPreview = false;\n          this.importError = error.error?.message || 'Error al cargar preview';\n          this.errorMessage = this.importError;\n          console.error('Error cargando preview:', error);\n        }\n      });\n    }\n    importData() {\n      if (!this.file || this.selectedSheets.size === 0) {\n        this.importError = 'Debe seleccionar al menos una hoja para importar';\n        return;\n      }\n      this.isImporting = true;\n      this.importError = '';\n      this.importMessage = '';\n      this.errorMessage = '';\n      this.successMessage = '';\n      this.apiService.importExcel(this.file, Array.from(this.selectedSheets)).subscribe({\n        next: response => {\n          this.isImporting = false;\n          if (response.status === 201 || response.status === 200) {\n            this.importMessage = 'Los datos fueron cargados correctamente a la base de datos';\n            this.successMessage = this.importMessage;\n            setTimeout(() => {\n              this.importComplete.emit();\n            }, 2000);\n          } else {\n            this.importError = response.message || 'Error al importar datos';\n            this.errorMessage = this.importError;\n          }\n        },\n        error: error => {\n          this.isImporting = false;\n          this.importError = error.error?.message || 'Error al importar datos';\n          this.errorMessage = this.importError;\n          console.error('Error importando datos:', error);\n        }\n      });\n    }\n    setActiveTab(sheetName) {\n      this.activeTab = sheetName;\n    }\n    getPreviewForSheet(sheetName) {\n      return this.previewData.find(p => p.sheet_name === sheetName);\n    }\n    getSheetData(sheetName) {\n      return this.getPreviewForSheet(sheetName);\n    }\n    get validSheets() {\n      if (!this.validationResult?.valid_sheets) return [];\n      return this.validationResult.valid_sheets.map(sheet => ({\n        name: sheet.name,\n        rows: sheet.rows || 0,\n        columns: sheet.columns || []\n      }));\n    }\n    get invalidSheets() {\n      if (!this.validationResult?.invalid_sheets) return [];\n      return this.validationResult.invalid_sheets.map(sheet => ({\n        name: sheet.name,\n        rows: sheet.rows || 0,\n        errors: sheet.errors || []\n      }));\n    }\n    get hasInvalidSheets() {\n      return this.invalidSheets.length > 0;\n    }\n    goBack() {\n      this.backToUpload.emit();\n    }\n    cancelPreview() {\n      this.showPreview = false;\n      this.previewData = [];\n      this.activeTab = '';\n    }\n    reset() {\n      this.selectedSheets.clear();\n      this.previewData = [];\n      this.showPreview = false;\n      this.activeTab = '';\n      this.importMessage = '';\n      this.importError = '';\n      this.errorMessage = '';\n      this.successMessage = '';\n    }\n    static {\n      this.ɵfac = function PreviewComponent_Factory(t) {\n        return new (t || PreviewComponent)();\n      };\n    }\n    static {\n      this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n        type: PreviewComponent,\n        selectors: [[\"app-preview\"]],\n        inputs: {\n          data: \"data\",\n          validationResult: \"validationResult\",\n          file: \"file\"\n        },\n        outputs: {\n          sheetsSelected: \"sheetsSelected\",\n          importComplete: \"importComplete\",\n          backToUpload: \"backToUpload\"\n        },\n        standalone: true,\n        features: [i0.ɵɵNgOnChangesFeature, i0.ɵɵStandaloneFeature],\n        decls: 26,\n        vars: 7,\n        consts: [[1, \"preview-container\"], [1, \"card\", \"validation-results\"], [1, \"validation-summary\"], [1, \"summary-item\", \"success\"], [1, \"summary-icon\"], [1, \"summary-number\"], [1, \"summary-label\"], [\"class\", \"summary-item error\", 4, \"ngIf\"], [1, \"summary-item\", \"info\"], [\"class\", \"sheets-section\", 4, \"ngIf\"], [\"class\", \"actions-container\", 4, \"ngIf\"], [\"class\", \"card preview-data slide-up\", 4, \"ngIf\"], [1, \"summary-item\", \"error\"], [1, \"sheets-section\"], [1, \"sheets-list\"], [\"class\", \"sheet-item valid\", 3, \"selected\", \"click\", 4, \"ngFor\", \"ngForOf\"], [1, \"sheet-item\", \"valid\", 3, \"click\"], [1, \"sheet-checkbox\"], [\"type\", \"checkbox\", 3, \"click\", \"checked\"], [1, \"sheet-info\"], [1, \"sheet-name\"], [1, \"sheet-rows\"], [1, \"sheet-status\"], [\"class\", \"sheet-item invalid\", 4, \"ngFor\", \"ngForOf\"], [1, \"sheet-item\", \"invalid\"], [1, \"sheet-errors\"], [4, \"ngFor\", \"ngForOf\"], [1, \"actions-container\"], [1, \"btn\", \"btn-primary\", 3, \"click\", \"disabled\"], [4, \"ngIf\"], [1, \"btn\", \"btn-secondary\", 3, \"click\"], [1, \"card\", \"preview-data\", \"slide-up\"], [1, \"tabs\"], [\"class\", \"tab\", 3, \"active\", \"click\", 4, \"ngFor\", \"ngForOf\"], [3, \"hidden\", 4, \"ngFor\", \"ngForOf\"], [1, \"tab\", 3, \"click\"], [3, \"hidden\"], [1, \"preview-info\"], [1, \"table-container\"], [1, \"badge\", 3, \"ngClass\"], [1, \"text-right\"]],\n        template: function PreviewComponent_Template(rf, ctx) {\n          if (rf & 1) {\n            i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"h2\");\n            i0.ɵɵtext(3, \"\\uD83D\\uDCCA Resultados de Validaci\\u00F3n\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(4, \"div\", 2)(5, \"div\", 3)(6, \"span\", 4);\n            i0.ɵɵtext(7, \"\\u2713\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(8, \"div\")(9, \"p\", 5);\n            i0.ɵɵtext(10);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(11, \"p\", 6);\n            i0.ɵɵtext(12, \"Hojas V\\u00E1lidas\");\n            i0.ɵɵelementEnd()()();\n            i0.ɵɵtemplate(13, PreviewComponent_div_13_Template, 8, 1, \"div\", 7);\n            i0.ɵɵelementStart(14, \"div\", 8)(15, \"span\", 4);\n            i0.ɵɵtext(16, \"\\uD83D\\uDCC4\");\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(17, \"div\")(18, \"p\", 5);\n            i0.ɵɵtext(19);\n            i0.ɵɵelementEnd();\n            i0.ɵɵelementStart(20, \"p\", 6);\n            i0.ɵɵtext(21, \"Total de Hojas\");\n            i0.ɵɵelementEnd()()()();\n            i0.ɵɵtemplate(22, PreviewComponent_div_22_Template, 5, 1, \"div\", 9)(23, PreviewComponent_div_23_Template, 5, 1, \"div\", 9);\n            i0.ɵɵelementEnd();\n            i0.ɵɵtemplate(24, PreviewComponent_div_24_Template, 6, 3, \"div\", 10)(25, PreviewComponent_div_25_Template, 6, 2, \"div\", 11);\n            i0.ɵɵelementEnd();\n          }\n          if (rf & 2) {\n            i0.ɵɵadvance(10);\n            i0.ɵɵtextInterpolate(ctx.validSheets.length);\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"ngIf\", ctx.invalidSheets.length > 0);\n            i0.ɵɵadvance(6);\n            i0.ɵɵtextInterpolate(ctx.validationResult.total_sheets);\n            i0.ɵɵadvance(3);\n            i0.ɵɵproperty(\"ngIf\", ctx.validSheets.length > 0);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.invalidSheets.length > 0);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.validSheets.length > 0);\n            i0.ɵɵadvance();\n            i0.ɵɵproperty(\"ngIf\", ctx.showPreview);\n          }\n        },\n        dependencies: [CommonModule, i1.NgClass, i1.NgForOf, i1.NgIf, i1.DecimalPipe],\n        styles: [\".preview-container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto}.validation-results[_ngcontent-%COMP%]{margin-bottom:2rem}.validation-summary[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:1.5rem;margin:2rem 0}.summary-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1.5rem;border-radius:var(--border-radius-sm);transition:transform var(--transition-fast)}.summary-item[_ngcontent-%COMP%]:hover{transform:translateY(-2px)}.summary-item.success[_ngcontent-%COMP%]{background:#48bb781a;border-left:4px solid var(--success-color)}.summary-item.error[_ngcontent-%COMP%]{background:#f565651a;border-left:4px solid var(--error-color)}.summary-item.info[_ngcontent-%COMP%]{background:#4299e11a;border-left:4px solid var(--info-color)}.summary-icon[_ngcontent-%COMP%]{font-size:2rem}.summary-number[_ngcontent-%COMP%]{font-size:2rem;font-weight:700;line-height:1;margin-bottom:.25rem}.summary-label[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.875rem}.sheets-section[_ngcontent-%COMP%]{margin:2rem 0}.sheets-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin-bottom:1rem;font-size:1.25rem}.sheets-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem}.sheet-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;padding:1rem 1.5rem;border-radius:var(--border-radius-sm);cursor:pointer;transition:all var(--transition-fast);border:2px solid transparent}.sheet-item.valid[_ngcontent-%COMP%]{background:#48bb780d;border-color:#48bb7833}.sheet-item.valid[_ngcontent-%COMP%]:hover{background:#48bb781a;border-color:var(--success-color)}.sheet-item.valid.selected[_ngcontent-%COMP%]{background:#48bb7826;border-color:var(--success-color);box-shadow:var(--shadow-md)}.sheet-item.invalid[_ngcontent-%COMP%]{background:#f565650d;border-color:#f5656533;cursor:default}.sheet-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{width:20px;height:20px;cursor:pointer}.sheet-info[_ngcontent-%COMP%]{flex:1}.sheet-name[_ngcontent-%COMP%]{font-weight:600;color:var(--text-primary);margin-bottom:.25rem}.sheet-rows[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.875rem}.sheet-status[_ngcontent-%COMP%]{font-size:1.5rem}.sheet-errors[_ngcontent-%COMP%]   details[_ngcontent-%COMP%]{cursor:pointer}.sheet-errors[_ngcontent-%COMP%]   summary[_ngcontent-%COMP%]{color:var(--error-color);font-weight:500}.sheet-errors[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:.5rem;padding-left:1.5rem}.sheet-errors[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.875rem;margin:.25rem 0}.actions-container[_ngcontent-%COMP%]{display:flex;gap:1rem;margin:2rem 0}.actions-container[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{flex:1}.preview-data[_ngcontent-%COMP%]{margin-top:2rem}.tabs[_ngcontent-%COMP%]{display:flex;gap:.5rem;margin:1.5rem 0;border-bottom:2px solid var(--border-color);overflow-x:auto}.tab[_ngcontent-%COMP%]{padding:.75rem 1.5rem;border:none;background:none;cursor:pointer;font-weight:500;color:var(--text-secondary);border-bottom:3px solid transparent;transition:all var(--transition-fast);white-space:nowrap}.tab[_ngcontent-%COMP%]:hover{color:var(--primary-color)}.tab.active[_ngcontent-%COMP%]{color:var(--primary-color);border-bottom-color:var(--primary-color)}.preview-info[_ngcontent-%COMP%]{margin:1rem 0;padding:.75rem 1rem;background:#667eea0d;border-radius:var(--border-radius-sm);color:var(--text-secondary)}.import-section[_ngcontent-%COMP%]{margin-top:2rem;text-align:center;padding:2rem;background:#48bb780d;border-radius:var(--border-radius-sm)}@media (max-width: 768px){.validation-summary[_ngcontent-%COMP%]{grid-template-columns:1fr}.actions-container[_ngcontent-%COMP%]{flex-direction:column}.tabs[_ngcontent-%COMP%]{flex-wrap:nowrap}}\"]\n      });\n    }\n  }\n  return PreviewComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}